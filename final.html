<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>ALT</title>
</head>
<body>
    <link rel="stylesheet" href="styles.css" />

    <p class="centerP">
        Thank you for your participation. Please press the "Copy to clipboard" button below to copy the survey code to put in SONA as proof of completion to recieve your credit. Make sure to not edit the code.
    </p>
    <br /><br />
    <p class="centerP">
      If there are any complications or you have any questions, please send a screenshot of this screen (if possible) to (indiestudyamt at gmail dot com) along with an explanation of the issue or your question. Thank you for completing our study.
    </p>

    <br />
    <p class="centerP">
        <textarea id="output" style="font-size:32px; text-align:center;"></textarea>
        <br/>
        <button id="contBtn" class="btn" onclick="copy()">Copy to clipboard</button>

    </p>
    <script src="boxes.js"></script>

</body>
</html>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<a id="downloadAnchorElem" style="display:none"></a>
<script>
  var today = new Date();
  localStorage.finalEnd = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();

  var output = {}
  output.id = localStorage.id
  output.preQ = {}
  output.postQ = {}
  output.time = {}


  output.preQ.age = localStorage.age
  output.preQ.CVWeakness = localStorage.CVWeakness
  output.preQ.education = localStorage.education
  output.from = localStorage.from
  output.postQ.comments = localStorage.comments
  output.postQ.changesS = localStorage.changesS
  output.postQ.weak = localStorage.weak
  output.postQ.changes = localStorage.changes
  output.time.end = localStorage.endTime
  output.preQ.gender = localStorage.gender
  output.intCond = localStorage.intCond
  output.midQs = localStorage.midQs
  output.preQ.MLExp = localStorage.MLExp
  output.ordCond = localStorage.ordCond
  output.rndCond = localStorage.rndCond
  output.pAns = localStorage.pAns
  output.time.start = localStorage.startTime
  output.time.firstE = localStorage.time0
  output.time.secondE = localStorage.time1
  output.time.thirdE = localStorage.time2
  output.time.firstS = localStorage.timeStart0
  output.time.secondS = localStorage.timeStart1
  output.time.thirdS = localStorage.timeStart2
  output.time.tutBegin = localStorage.tutBegin
  output.time.finalEnd = localStorage.finalEnd
  output.trust1 = localStorage.trust1
  output.trust2 = localStorage.trust2
  output.trust3 = localStorage.trust3
  output.trustUses = localStorage.trustUses
  output.userTrust = localStorage.userTrust
  output.userRelevant = localStorage.userRelevant
  output.userTrust = localStorage.userTrust
  output.userHighlights = localStorage.userHighlights

  // var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(output));
  // var dlAnchorElem = document.getElementById('downloadAnchorElem');
  // dlAnchorElem.setAttribute("href",     dataStr     );
  // dlAnchorElem.setAttribute("download", output.id + ".json");
  // dlAnchorElem.click();

  document.getElementById('output').setAttribute("innerText", JSON.stringify(output))

  IDBox = document.getElementById("output")
  // IDBox.value = JSON.stringify(output)
  IDBox.value = "lj3k92s"
  IDBox.style.display = 'none'

  $.ajax({
      type : "POST",
      url : "json.php",
      data : {
          json : JSON.stringify(output)
      }
    });

  function copy() {
    IDBox.style.display = ''
    IDBox.select()
    document.execCommand('copy')
    IDBox.style.display = 'none'
    alert("Code successfully copied. Remember, do not edit the copied code when pasting it into SONA.")
  }

  //continueBtn.style.background = "#A9A9A9";

  //Handle sliders
  //var slider1 = document.getElementById("q1");
  //slider1.value = 50
  //var output1 = document.getElementById("q1Val");
  //output1.innerHTML = "??"; // Display the default slider value

  // Update the current slider value (each time you drag the slider handle)
  //slider1.onclick = function() {
  //  output1.innerHTML = this.value;
  //  slider1.className = "sliderA"
  //  continueBtn.style.background = "#4CAF50"
  //  answered = 1
  //}


  //Setup timer to simulate the system implementing the responses
  //implementing = false
  //if(parseInt(localStorage.intCond) > 0) {
  //  implementing = true
  //  setTimeout(delayContinue, 60000)  //1 minute delay

  //  //Setup rotating gear icon
  //  i = 1;
  //  setInterval(turnGear, 500)
  //}
  //else {
  //  document.getElementById("gear").style.display = "none"
  //}
  //Questionnaire completion check
  const isComplete = (currentValue) => currentValue == 1


  function submit() {
    weak = document.getElementById("weak").value
    comments = document.getElementById("comments").value
    answered = 1

    if (weak == "") {
        answered = 0
    }
    if (comments == "") {
        answered = 0
    }
    if (answered == 0) {
      alert("You must answer all questions before continuing")
    }
    else {
        localStorage.weak = JSON.stringify(weak)
        localStorage.comments = JSON.stringify(comments)
        complete()
        //window.location.href = "binaryInteraction.html"

    }
  }

  function complete() {
    //TODO: Output values to json file

    //TODO: Move to final page (what to put here for AMT/SONA I don't know)

    alert("Done")
  }

</script>
